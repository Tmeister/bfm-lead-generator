!function($){"use strict";$.fn.bfmForm=function(n){if(!this.length)return this;var e=$.extend(!0,{},$.fn.bfmForm.defaults,n);return this.each(function(){function n(){return p.parsley().validate("block"+(x+1))}function a(){var n=null;switch(_.hide(),x){case 0:n="4"===e.steps?t():f();break;case 1:n="4"===e.steps?s():r();break;case 2:n="4"===e.steps?o():c();break;case 3:n="4"===e.steps?i():"NULL"}}function t(){var n=d.find(".bfm-email").val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_email",nonce:bfm.nonce,email:n}}).done(function(n){"success"===n.status&&(T=n.user_id,l()),"fail"===n.status&&_.html(n.message).show()}).fail(function(){console.log("error")})}function s(){var n=d.find(".bfm-name").val(),e=d.find(".bfm-phone").val(),a=d.find("#bfm-best-time").val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_name_phone_best",nonce:bfm.nonce,name:n,phone:e,best_time:a,user_id:T}}).done(function(n){"success"===n.status&&l(),"fail"===n.status&&_.html(n.message).show()}).fail(function(){console.log("error")})}function o(){var n=d.find("#bfm-property-status").val(),e=d.find("#bfm-rent-price").val(),a=$("input[name=property-manager]:checked",d).val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_status_rent_manager",nonce:bfm.nonce,status:n,rent:e,manager:a,user_id:T}}).done(function(n){"success"===n.status&&l(),"fail"===n.status&&_.html(n.message).show()}).fail(function(){console.log("error")})}function i(){var n=d.find("#bfm-comments").val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_comments",nonce:bfm.nonce,comments:n,user_id:T}}).done(function(n){"success"===n.status&&(b.hide(),l()),"fail"===n.status&&_.html(n.message).show()}).fail(function(){console.log("error")})}function f(){var n=d.find(".bfm-email").val(),e=d.find(".bfm-name").val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_email_and_name",nonce:bfm.nonce,email:n,name:e}}).done(function(n){"success"===n.status&&(T=n.user_id,l()),"fail"===n.status&&_.html(n.message).show()}).fail(function(){console.log("error")})}function r(){var n=d.find(".bfm-phone").val(),e=d.find("#bfm-best-time").val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_phone_best",nonce:bfm.nonce,phone:n,best_time:e,user_id:T}}).done(function(n){"success"===n.status&&l(),"fail"===n.status&&_.html(n.message).show()}).fail(function(){console.log("error")})}function c(){var n=d.find("#bfm-property-status").val(),e=d.find("#bfm-rent-price").val(),a=$("input[name=property-manager]:checked",d).val(),t=d.find("#bfm-comments").val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_aditional_fields",nonce:bfm.nonce,status:n,rent:e,manager:a,comments:t,user_id:T}}).done(function(n){"success"===n.status&&(b.hide(),l()),"fail"===n.status&&_.html(n.message).show()}).fail(function(){console.log("error")})}function l(){w=!0;var n=$(h[x]),e=$(h[x+1]);u(x+1),n.animate({left:"-100%"},500),e.animate({left:"0%"},500,function(){w=!1}),x+=1}function u(n){for(var e=$(h[n]),a=e.find(".bfm-field"),t=0,s=a.length-1;s>=0;s--){var o=$(a[s]);o.is(":visible")&&(t+=o.height()+40)}y.animate({height:t+"px"},500)}function m(){var n="4"===e.steps?1:2;$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_form_hit",form_id:n,nonce:bfm.nonce}}).done(function(){console.log("success")}).fail(function(){console.log("error")})}var d=$(this),p=d.find("form"),b=d.find(".next"),h=d.find("fieldset"),v=$(window),_=d.find(".error"),y=d.find(".mask"),g=d.find(".rent-price"),j=d.find("#bfm-property-status"),x=0,T,w=!1;p.parsley(),g.hide(),d.find("select").select2({minimumResultsForSearch:-1,width:"98%"}),d.keydown(function(n){var e=n.keyCode||n.which;9===e&&n.preventDefault()}),d.find(".bfm-phone").mask("(999) 999-9999"),j.on("change",function(n){"3"===$("option:selected",j).val()?g.fadeIn("slow",function(){u(x)}):g.fadeOut("slow",function(){u(x)})}),b.live("click",function(e){return w?!1:void(n()&&a(d,h))}),u(0),m()}),this},$.fn.bfmForm.defaults={layout:"horizontal",steps:"4"}}(jQuery);