!function($){"use strict";$.fn.bfmForm=function(n){if(!this.length)return this;var a=$.extend(!0,{},$.fn.bfmForm.defaults,n);return this.each(function(){function n(){return h.parsley().validate("block"+(w+1))}function e(){var n=null;switch(v.hide(),w){case 0:n="4"===a.steps?t():f();break;case 1:n="4"===a.steps?o():r();break;case 2:n="4"===a.steps?s():c();break;case 3:n="4"===a.steps?i():"NULL"}}function t(){var n=m.find(".bfm-email").val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_email",nonce:bfm.nonce,email:n}}).done(function(n){"success"===n.status&&(x=n.user_id,l()),"fail"===n.status&&v.html(n.message).show()}).fail(function(){console.log("error")})}function o(){var n=m.find(".bfm-name").val(),a=m.find(".bfm-phone").val(),e=m.find("#bfm-best-time").val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_name_phone_best",nonce:bfm.nonce,name:n,phone:a,best_time:e,user_id:x}}).done(function(n){"success"===n.status&&l(),"fail"===n.status&&v.html(n.message).show()}).fail(function(){console.log("error")})}function s(){var n=m.find("#bfm-property-status").val(),a=m.find("#bfm-rent-price").val(),e=$("input[name=property-manager]:checked",m).val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_status_rent_manager",nonce:bfm.nonce,status:n,rent:a,manager:e,user_id:x}}).done(function(n){"success"===n.status&&l(),"fail"===n.status&&v.html(n.message).show()}).fail(function(){console.log("error")})}function i(){var n=m.find("#bfm-comments").val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_comments",nonce:bfm.nonce,comments:n,user_id:x}}).done(function(n){"success"===n.status&&(p.hide(),n.thanks_url&&(window.location.href=n.thanks_url)),"fail"===n.status&&v.html(n.message).show()}).fail(function(){console.log("error")})}function f(){var n=m.find(".bfm-email").val(),a=m.find(".bfm-name").val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_email_and_name",nonce:bfm.nonce,email:n,name:a}}).done(function(n){"success"===n.status&&(x=n.user_id,l()),"fail"===n.status&&v.html(n.message).show()}).fail(function(){console.log("error")})}function r(){var n=m.find(".bfm-phone").val(),a=m.find("#bfm-best-time").val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_phone_best",nonce:bfm.nonce,phone:n,best_time:a,user_id:x}}).done(function(n){"success"===n.status&&l(),"fail"===n.status&&v.html(n.message).show()}).fail(function(){console.log("error")})}function c(){var n=m.find("#bfm-property-status").val(),a=m.find("#bfm-rent-price").val(),e=$("input[name=property-manager]:checked",m).val(),t=m.find("#bfm-comments").val();$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_aditional_fields",nonce:bfm.nonce,status:n,rent:a,manager:e,comments:t,user_id:x}}).done(function(n){"success"===n.status&&(p.hide(),n.thanks_url&&(window.location.href=n.thanks_url)),"fail"===n.status&&v.html(n.message).show()}).fail(function(){console.log("error")})}function l(){T=!0;var n=$(b[w]),a=$(b[w+1]);u(w+1),n.animate({left:"-100%"},500),a.animate({left:"0%"},500,function(){T=!1}),w+=1}function u(n){for(var a=$(b[n]),e=a.find(".bfm-field"),t=0,o=e.length-1;o>=0;o--){var s=$(e[o]);s.is(":visible")&&(t+=s.height()+40)}y.animate({height:t+"px"},500)}function d(){var n="4"===a.steps?1:2;$.ajax({url:bfm.ajax_url,type:"POST",dataType:"json",data:{action:"add_form_hit",form_id:n,nonce:bfm.nonce}}).done(function(){console.log("success")}).fail(function(){console.log("error")})}var m=$(this),h=m.find("form"),p=m.find(".next"),b=m.find("fieldset"),_=$(window),v=m.find(".error"),y=m.find(".mask"),g=m.find(".rent-price"),j=m.find("#bfm-property-status"),w=0,x,T=!1;h.parsley(),g.hide(),m.find("select").select2({minimumResultsForSearch:-1,width:"98%"}),m.keydown(function(n){var a=n.keyCode||n.which;9===a&&n.preventDefault()}),m.find(".bfm-phone").mask("(999) 999-9999"),j.on("change",function(n){"3"===$("option:selected",j).val()?g.fadeIn("slow",function(){u(w)}):g.fadeOut("slow",function(){u(w)})}),p.live("click",function(a){return T?!1:void(n()&&e(m,b))}),u(0),d()}),this},$.fn.bfmForm.defaults={layout:"horizontal",steps:"4"}}(jQuery);